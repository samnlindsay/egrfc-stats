<!DOCTYPE html>
<html lang="en">

<head>
    <title>EGRFC Stats</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:100,300,400,700,900">
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans:800'>
    <link rel='stylesheet' href="https://fonts.googleapis.com/css2?family=PT+Sans+Narrow">
    <link rel='stylesheet' href="https://fonts.googleapis.com/css2?family=PT+Sans">
    <link rel='stylesheet' href="https://fonts.googleapis.com/css2?family=Oswald:200,400,600">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container text-center" style="width:100%; max-width: 100%; height:100%">

        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg navbar-dark w-100 position-fixed top-0" style="display: none;">
            <div class="container-fluid">
                <a class="navbar-brand" href="index.html">
                    <img src="https://img-res.pitchero.com/?url=images.pitchero.com%2Fclub_logos%2F4860%2Fq8XL0Ot4QSqgy8nOKnCb_Logo.png&bg=null&h=250&w=250&t=square&q=null"
                        alt="Team Logo" style="max-width: 100px;">
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link active" href="index.html" onclick="showHomePage(event)">Home</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownTeam" role="button"
                                data-bs-toggle="dropdown" aria-expanded="false">Team Stats</a>
                            <ul class="dropdown-menu" aria-labelledby="navbarDropdownTeam">
                                <li><a class="dropdown-item" href="#"
                                        onclick="loadPage('Charts/results.html')">Results</a></li>
                                <li><a class="dropdown-item" href="#" onclick="loadPage('Charts/game-stats.html')">1st
                                        XV Game Stats
                                        <em>(2024/25 only)</em></a></li>
                                <li><a class="dropdown-item" href="#" onclick="loadPage('Charts/set-piece.html')">Set
                                        Piece Results</a></li>

                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li class="dropdown-header">1st XV Lineout Stats</li>
                                <li><a class="dropdown-item" href="#" onclick="loadPage('Charts/1s-lineouts.html')">All
                                        Seasons</a></li>
                                <li><a class="dropdown-item" href="#"
                                        onclick="loadPage('Charts/2021-22/1s-lineouts.html')">2021/22</a></li>
                                <li><a class="dropdown-item" href="#"
                                        onclick="loadPage('Charts/2022-23/1s-lineouts.html')">2022/23</a></li>
                                <li><a class="dropdown-item" href="#"
                                        onclick="loadPage('Charts/2023-24/1s-lineouts.html')">2023/24</a></li>
                                <li><a class="dropdown-item" href="#"
                                        onclick="loadPage('Charts/2024-25/1s-lineouts.html')">2024/25</a></li>

                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li class="dropdown-header">2nd XV Lineout Stats</li>
                                <li><a class="dropdown-item" href="#" onclick="loadPage('Charts/2s-lineouts.html')">All
                                        Seasons</a></li>
                                <li><a class="dropdown-item" href="#"
                                        onclick="loadPage('Charts/2022-23/2s-lineouts.html')">2022/23</a></li>
                                <li><a class="dropdown-item" href="#"
                                        onclick="loadPage('Charts/2023-24/2s-lineouts.html')">2023/24</a></li>
                                <li><a class="dropdown-item" href="#"
                                        onclick="loadPage('Charts/2024-25/2s-lineouts.html')">2024/25</a></li>
                            </ul>
                        </li>

                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownPlayer" role="button"
                                data-bs-toggle="dropdown" aria-expanded="false">Player Stats</a>
                            <ul class="dropdown-menu" aria-labelledby="navbarDropdownPlayer">
                                <li><a class="dropdown-item" href="#"
                                        onclick="loadPage('Charts/appearances.html')">Appearances</a></li>
                                <li><a class="dropdown-item" href="#" onclick="loadPage('Charts/positions.html')">Starts
                                        by Position</a></li>
                                <li><a class="dropdown-item" href="#"
                                        onclick="loadPage('Charts/captains.html')">Captains</a></li>
                                <li><a class="dropdown-item" href="#"
                                        onclick="loadPage('Charts/points.html')">Scorers</a></li>
                                <li><a class="dropdown-item" href="#" onclick="loadPage('Charts/cards.html')">Cards</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- Content Section -->
        <div id="home-content" class="container d-flex align-items-center justify-content-center"
            style="width:100%; max-width: 100%; height:100%">
            <!-- Initially visible content (buttons, etc.) -->
            <img src="https://img-res.pitchero.com/?url=images.pitchero.com%2Fclub_logos%2F4860%2Fq8XL0Ot4QSqgy8nOKnCb_Logo.png&bg=null&h=250&w=250&t=square&q=null"
                - alt="Team Logo" style="width: 50%; max-width:500px; margin-bottom:20px" />
            <div class="row justify-content-center w-100">
                <!-- First Column -->
                <div class="col-6 col-md-3   d-flex flex-column">
                    <h1 class="mb-3">Team Stats</h1>
                    <button class="btn custom-btn w-100" onclick="loadPage('Charts/results.html')">Results</button>
                    <button class="btn custom-btn w-100" onclick="loadPage('Charts/game-stats.html')">1st XV Game Stats
                        <br><em>(2024/25 only)</em></button>
                    <button class="btn custom-btn w-100" onclick="loadPage('Charts/set-piece.html')">Set Piece
                        Results</button>
                    <button class="btn custom-btn w-100 dropdown-toggle" type="button" id="lineoutDropdown"
                        data-bs-toggle="dropdown" aria-expanded="false">Lineout Analysis</button>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="#" onclick="loadPage('Charts/1s-lineouts.html')">1st XV - All
                            Seasons</a>
                        <a class="dropdown-item" href="#" onclick="loadPage('Charts/2021-22/1s-lineouts.html')">1st XV -
                            2021/22</a>
                        <a class="dropdown-item" href="#" onclick="loadPage('Charts/2022-23/1s-lineouts.html')">1st XV -
                            2022/23</a>
                        <a class="dropdown-item" href="#" onclick="loadPage('Charts/2023-24/1s-lineouts.html')">1st XV -
                            2023/24</a>
                        <a class="dropdown-item" href="#" onclick="loadPage('Charts/2024-25/1s-lineouts.html')">1st XV -
                            2024/25</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#" onclick="loadPage('Charts/1s-lineouts.html')">2nd XV - All
                            Seasons</a>
                        <a class="dropdown-item" href="#" onclick="loadPage('Charts/2022-23/1s-lineouts.html')">2nd XV -
                            2022/23</a>
                        <a class="dropdown-item" href="#" onclick="loadPage('Charts/2023-24/1s-lineouts.html')">2nd XV -
                            2023/24</a>
                        <a class="dropdown-item" href="#" onclick="loadPage('Charts/2024-25/1s-lineouts.html')">2nd XV -
                            2024/25</a>
                    </div>
                </div>

                <!-- Second Column -->
                <div class="col-6 col-md-3 d-flex flex-column">
                    <h1 class="mb-3">Player Stats</h1>
                    <button class="btn custom-btn w-100 dropdown-toggle" type="button" id="lineoutDropdown"
                        data-bs-toggle="dropdown" aria-expanded="false">Appearances</button>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="#" onclick="loadPage('Charts/appearances.html')">Total</a>
                        <a class="dropdown-item" href="#" onclick="loadPage('Charts/positions.html')">Starts by
                            Position</a>
                    </div>
                    <button class="btn custom-btn" onclick="loadPage('Charts/captains.html')">Captains</button>
                    <button class="btn custom-btn" onclick="loadPage('Charts/points.html')">Scorers</button>
                    <button class="btn custom-btn" onclick="loadPage('Charts/cards.html')">Cards</button>
                </div>
            </div>
        </div>

        <!-- Placeholder for dynamic content -->
        <div id="dynamic-content" class="iframe-container hidden">
            <iframe id="chart-frame"
                style="width: 100%; height: 100%; border: none; background-color: whitesmoke;"></iframe>
        </div>

        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

        <script>
            function loadPage(url) {
                console.log("Loading page:", url);

                document.querySelector('nav.navbar').style.display = 'block';

                let homeContent = document.getElementById('home-content');
                homeContent.classList.add("hidden");

                let dynamicContent = document.getElementById('dynamic-content');
                dynamicContent.classList.remove("hidden");

                let iframe = document.getElementById('chart-frame');
                iframe.src = url;

                // Close navbar if open
                let navbarToggler = document.querySelector('.navbar-toggler');
                if (navbarToggler.getAttribute('aria-expanded') === 'true') {
                    navbarToggler.click();
                }
            }

            function showHomePage(event) {
                event.preventDefault();
                console.log("Returning to home page");

                // Hide the navbar
                document.querySelector('nav.navbar').style.display = 'none';

                // Show home-content
                let homeContent = document.getElementById('home-content');
                homeContent.classList.remove("hidden");

                // Hide dynamic content
                let dynamicContent = document.getElementById('dynamic-content');
                dynamicContent
            }

            document.addEventListener("DOMContentLoaded", function () {
                    const iframe = document.getElementById("chart-frame");

                    function getScaleFactor() {
                        if (window.innerWidth <= 480) {
                            return 0.7; // Mobile
                        } else if (window.innerWidth <= 768) {
                            return 0.8; // Tablet
                        } else {
                            return 1; // Desktop (no scaling)
                        }
                    }

                    function applyScaling() {
                        const scaleFactor = getScaleFactor();

                        // Ensure iframe takes full width
                        iframe.style.width = "100%";
                        iframe.style.height = "100%";

                        // Wait for the iframe to load
                        iframe.onload = function () {
                            const iframeDoc = iframe.contentWindow.document;
                            const vegaEmbed = iframeDoc.querySelector('.vega-embed');

                            if (vegaEmbed) {
                                // Apply scale factor to the vega-embed element
                                vegaEmbed.style.width = `${100 * scaleFactor}%`;
                            }
                        };
                    }

                    // Apply scaling on initial load
                    applyScaling();

                    // Apply scaling when the window is resized
                    window.addEventListener("resize", applyScaling);
                });


        </script>

</body>

</html>